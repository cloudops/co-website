<!DOCTYPE html>
<html><head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

   
   
   
   
   <link rel="stylesheet" as="style" type="text/css" href="/css/style.min.ffc82ac39d7e27734f941f1d1f55d0ee976305004ef32340c769aabc72e1bf7f.css" integrity="sha256-/8gqw51&#43;J3NPlB8dH1XQ7pdjBQBO8yNAx2mqvHLhv38=" crossorigin="anonymous" media="screen" />
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
    <link rel="icon no-follow" href="/images/favicon.ico" type="image/x-icon">
    
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,600,600i,700|Open+Sans:400,700&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/d8b2e2ddb4.js" crossorigin="anonymous"></script>


    
        <title>CloudOps - RÃ©seautage Kubernetes 101</title>
    
</head><body>
            
            
<div class="navbar-card" id="main-nav">
  <nav class="navbar navbar-expand-xl">
    
    <a class="navbar-brand mr-auto" href="/">
      <img src="/images/CO-logo-horizontal.svg" width="230px" alt="CloudOps logo">
    </a>
    <a class="navbar-toggler" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"><i class="fas fa-hamburger"></i></span>
    </a>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto list-group list-group-flush">

        <li class="nav-item dropdown">
          <a class="nav-link" href="/solutions" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">Solutions</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <div class="row">
              <div class="col-xl-12 nav-main-section">
                <a href="/solutions"><button>Solutions Overview</button></a>
              </div>
            </div>
            <div class="row">
              <div class="col-xl-3 offset-xl-1 col-lg-3 offset-lg-0 solutions-dropdown-items-group">
                <a href="/using-cloud"><h3 class="dropdown-item list-group-item list-group-item-action">Using Cloud</h3></a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/cloud-native-consulting">Cloud Native Consulting</a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/cloud-migration">Cloud Migration</a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/managed-services-augmented-support">Managed Services <br> Augmented Support</a>



              </div>
              <div class="col-xl-3 offset-xl-0 col-lg-3 offset-lg-1 solutions-dropdown-items-group">
                <a href="/delivering-cloud"><h3 class="dropdown-item list-group-item list-group-item-action">Delivering Cloud</h3></a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/delivering-cloud-consulting">Consulting</a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/managed-services-augmented-support">Managed Services <br> Augmented Support</a>
              </div>

              <div class="col-xl-3 offset-xl-0 col-lg-3 offset-lg-1 solutions-dropdown-items-group">
                <a href="/transformations"><h3 class="dropdown-item list-group-item list-group-item-action">Transformations</h3></a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/transformations/#devops-transformation">DevOps Transformation</a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/transformations/#cloudops-transformation">CloudOps Transformation</a>
                <a class="dropdown-item list-group-item list-group-item-action" href="/transformations/#devnetops">DevNetOps Transformation</a>
              </div>
            </div>
            <div class="row">
              <div class="col-xl-3 nav-cta">
                <img src="/images/navbar-arrows.svg">
              </div>
              <div class="col-xl-9 nav-cta horizontal-nav-cta">
                  <a href="/devops-platform-practices-assessment" target="_blank"><h2>Not sure where to start?</h2>
                <p>Your journey with CloudOps begins with a DevOps Platform and Practices Assessment to get an objective status report and recommendations</p><div class="triangle-right">
                    <div class="inner-triangle"></div></a>
              </div>
            </div>
          </div>
        </li>
        <li class="nav-item dropdown" id="training-dropdown-menu">
          <a class="nav-link" href="/training" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Training</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <div class="row solutions-dropdown-row">
              <div class="col-xl-4 col-lg-4 training-dropdown-items-group">
                  <a class="dropdown-item list-group-item list-group-item-action" href="/workshops">
                <img src="/images/nav-workshops.svg" height="70px">
                <h3>Workshops</h3></a>
              </div>
              <div class="col-xl-4 col-lg-4 training-dropdown-items-group">
                  <a class="dropdown-item list-group-item list-group-item-action" href="/experts">
                <img src="/images/nav-experts.svg" height="70px">
                <h3>Our Experts</h3></a>
              </div>
              <div class="col-xl-4 col-lg-4 training-dropdown-items-group">
                  <a class="dropdown-item list-group-item list-group-item-action" href="/calendar">
                <img src="/images/nav-calendar.svg" height="70px">
                <h3>Calendar</h3></a>
              </div>
            </div>
            <div class="row">
              <div class="col-xl-3 nav-cta">
                <img src="/images/navbar-arrows.svg">
              </div>
              <div class="col-xl-9 nav-cta horizontal-nav-cta">
                <a href="/blog/quiz-are-you-a-kubernetes-unicorn/" target="_blank">
                <h2>Are you a Kubernetes unicorn?</h2>
                <p>Take our quiz to find out</p>
              </a>
              </div>
            </div>
          </div>
        </li>
        <li class="nav-item dropdown reading-dropdown">
          <a class="nav-link" href="/reading" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
            data-reference="parent" data-offset="50%,20" aria-haspopup="true" aria-expanded="false">Reading</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <div class="row">
              <div class="col-xl-3 nav-cta">
                <img src="/images/navbar-arrows.svg">
                <a href="https://cdn2.hubspot.net/hubfs/732832/Gated%20Content/WP_Securing%20Your%20DevOps%20Platform%20Enterprise_2019.pdf" target="_blank">
                <h2>Secure your DevOps platform</h2>
                <p>White paper highlighting how to handle security challenges faced by enterprises</p>
                </a>
              </div>
              <div class="col-xl-9">
                <div class="row solutions-dropdown-row">
                  <div class="col-xl-2 offset-xl-1 col-lg-2 offset-lg-1">
                      <a href="/blog"><img src="/images/nav-blog.svg" height="70px"></a>
                  </div>
                  <div class="col-xl-3 col-lg-3">
                      <a href="/blog"><h3 class="dropdown-item list-group-item list-group-item-action">Blog</h3></a>
                      <a class="dropdown-item list-group-item list-group-item-action" href="/blog">Blog Posts</a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/blog#community-news">Community News</a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/blog#cloudops-press">CloudOps Press</a>
                  </div>
                  <div class="col-xl-2 offset-xl-0 col-lg-2">
                      <a href="/resources"><img src="/images/nav-resources.svg" height="70px"></a>
                  </div>
                  <div class="col-xl-3 col-lg-3">
                    <a href="/resources"><h3 class="dropdown-item list-group-item list-group-item-action">Resources</h3></a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/resources/white-papers/">White Papers</a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/resources/case-studies/">Case Studies</a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/resources/infographics/">Infographics</a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/resources/one-pagers/">One Pagers</a>
                  </div>
                </div>
              </div>
            </div>
        </li>
        <li class="nav-item dropdown company-dropdown">
          <a class="nav-link" href="/company" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown"
            data-reference="parent" data-offset="50%,20" aria-haspopup="true" aria-expanded="false">Company</a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <div class="row">
              <div class="col-xl-3 nav-cta">
                <img src="/images/navbar-arrows.svg">
                <a href="/blog/cloudops-manifesto/" target="_blank">
                <h2>The CloudOps Manifesto</h2>
                <p>11 key success factors we have learned from our adventures in the cloud</p></a>
              </div>
              <div class="col-xl-6 nav-main-section">
                <a href="/why-cloudops"><button>Why choose CloudOps</button></a>
                <div class="row sub-nav-items">
                  <div class="col-xl-3 offset-xl-2 col-lg-3 offset-lg-3">
                    <img src="/images/description-logo.svg" width="70px">
                  </div>
                  <div class="col-xl-6 col-lg-6">
                    <a class="dropdown-item list-group-item list-group-item-action" href="/about-us"><h3>About Us</h3></a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/partners"><h3>Partners</h3></a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/careers"><h3>Careers</h3></a>
                    <a class="dropdown-item list-group-item list-group-item-action" href="/calendar#events"><h3>Events Calendar</h3></a>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 nav-cta">
                <img src="/images/navbar-arrows.svg">
                <a href="blog/staff-augmentation-vs-project-based-services-for-devops-and-cloud-projects/">
                <h2>Accelerate your software release cycles</h2>
                <p>Comparing staff augmentation to project-based services for DevOps and cloud projects</p>
                </a>
              </div>
            </div>
          </div>
        </li>
        <li class="nav-item">
          <a href="/contact-us"><button class="btn" type="submit">Contact</button></a>
        </li>
 
        

      </ul>
    </div>

  </nav>

  

</div><div class="container-fluid main-content">
<main class="post">
    <div class="row">
        <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 col-md-10 offset-md-1 col-sm-12 col-xs-12">
            <article>
                <header>
                    <h1>RÃ©seautage Kubernetes 101</h1>
                    <div> June 3, 2020 / Chanpreet Kaur </div>
                </header>
                
                
                
                <img src="/fr/blog/reseautage-kubernetes-101/K8s-Networking_hu3d38fb4d20789838caf078b11a3ef3ad_160923_400x0_resize_q75_box.jpg" />
                
                
                <p>Le rÃ©seautage est un Ã©lÃ©ment trÃ¨s important lorsquâil sâagit dâarchitectures basÃ©es sur les miscroservices. Kubernetes offre un soutien de premiÃ¨re classe pour toute une gamme de configurations de rÃ©seautage diffÃ©rentes. Essentiellement, il vous offre un rÃ©seau simple et isolÃ© Ã  lâÃ©chelle du cluster. En arriÃ¨re-scÃ¨ne, le rÃ©seautage Kubernetes peut Ãªtre trÃ¨s complexe Ã  cause de tous les diffÃ©rents modules dâextension de rÃ©seautage. Il serait utile de garder en tÃªte les concepts les plus simples avant dâessayer dâidentifier le flux de paquets de rÃ©seautage individuels.</p><p>Il est important dâavoir une assez bonne comprÃ©hension des diffÃ©rents types de services et  dâingresses afin de choisir la configuration adÃ©quate pour votre cluster et ainsi minimiser la complexitÃ© et les ressources impliquÃ©es (comme des Ã©quilibreurs de charge provisionnÃ©s).</p><p>Pour commencer, voici quelques notions utiles :</p><p>1. Chaque pod se voit assigner une adresse IP unique.</p><p>2. Les pods sont exploitÃ©s au sein dâun rÃ©seau virtuel, spÃ©cifiÃ© par le rÃ©seautage CIDR (routage interdomaine sans classe) du pod.</p><p>3. Les conteneurs Ã  lâintÃ©rieur dâun pod individuel partagent le mÃªme namespace de rÃ©seau (Linux network namespace), cela signifie quâils peuvent tous Ãªtre rejoints via un hÃ´te local (localhost) et quâils partagent le mÃªme espace de port.</p><p>4. Tous les conteneurs sont configurÃ©s de faÃ§on Ã  utiliser un serveur DNS qui est gÃ©rÃ© par Kubernetes.</p><h3>Fournir un accÃ¨s externe Ã  votre cluster</h3><p>Le processus qui requiert un accÃ¨s externe pour entrer dans votre cluster fonctionne un peu diffÃ©remment que de simplement Ã©couter sur un port ouvert. Ã la place, un service dâentrÃ©e dâÃ©quilibreur de charge (<em>LoadBalancer</em>) ou un service de <em>NodePort</em> sera utilisÃ©, on en reparlera ci-dessous.</p><h3>Inspection de lâadresse IP dâun pod</h3><p>Il est souvent utile dâidentifier lâadresse IâP dâun pod. Cette valeur se trouve dans les mÃ©tadonnÃ©es Ã  lâintÃ©rieur de lâÃ©tat du cluster Kubernetes.</p><p>Vous pouvez effectuer lâinspection de lâadresse IP en suivant les commandes suivantes :</p><pre class="wp-block-code"><code>$ kubectl get pod -o yaml busybox | grep podIP
podIP: 10.10.3.4</code></pre><p>De cette maniÃ¨re, vous Ã©viterez dâavoir Ã  exÃ©cuter manuellement dans le conteneur avec la commande ip addr ou autrement. Vous pouvez aussi visualiser cela avec lâargument <strong>-o wide</strong> vers <strong>kubectl get pods</strong>.</p><pre class="wp-block-code"><code>$ kubectl get pods -o wide
NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES
busybox 0/1 Completed 0 2d8h 10.10.3.4 node-1 &lt;none&gt; &lt;none&gt;</code></pre><h2>Services</h2><p>Lâun des principes fondamentaux de rÃ©seautage dans Kubernetes est un service. Tout comme les dÃ©ploiements, les services sont dÃ©finis de faÃ§on dÃ©clarative et ont des Â«&thinsp;contrÃ´leurs&thinsp;Â» qui y sont associÃ©s qui regardent et qui approvisionnent les ressources autour du service. Les services sont reliÃ©s au concept de Â«&thinsp;dÃ©couverte de service&thinsp;Â», ce qui signifie de permettre aux diffÃ©rentes applications de se dÃ©couvrir ou de communiquer entre elles. Les services simplifient le processus de gestion des adresses IP individuelles autour de conteneurs en fonction.</p><p>En termes pratiques, par exemple, un service peut cibler un ou plusieurs pods exploitÃ©s sur nâimporte quels nÅuds de cluster. Cela arrive habituellement via une rÃ©solution DNS privÃ©e et interne. Pour chaque service dÃ©fini, Kubernetes crÃ©era une entrÃ©e DNS. Cela permet aux pods de chercher les noms dâhÃ´tes et de recevoir la bonne adresse IP de pod.</p><h3>Types de service</h3><p>Il existe une grande variÃ©tÃ© de configurations de services qui sont soutenues. Voici les quatre types de services de base:</p><h4>Adresse IP de base : Cluster IP</h4><p>Câest le type de service par dÃ©faut et lâun des plus simples. Deux grandes<br> propriÃ©tÃ©s sont dÃ©finies, le nom du service et le sÃ©lecteur. Le nom du service est un identifiant unique, tandis que le sÃ©lecteur prÃ©cise ce que le service doit router vers la cible.</p><h4>NodePort</h4><p>Les NodePorts sont semblables aux Cluster IP sauf que tous les nÅuds ont<br> des ports, soit spÃ©cifiÃ©s ou alÃ©atoires, attribuÃ©s Ã  leur service. Les requÃªtes de rÃ©seaux vers des ports sur nâimporte quels des nÅuds sont mandatÃ©s dans le service.</p><h4>Ãquilibreur de charge</h4><p>Les Ã©quilibreurs de charge sont semblables aux ClusterIP, mais ils sont provisionnÃ©s de faÃ§on externe et ont des adresses IP publiques qui leur sont assignÃ©es. LâÃ©quilibreur de charge sera spÃ©cifique Ã  la mise en Åuvre. On lâutilise souvent dans des plateformes infonuagiques.</p><h4>Nom externe</h4><p>Deux grandes propriÃ©tÃ©s sont dÃ©finies, le nom du service et le domaine externe&thinsp;; un alias de nom de domaine, en quelque sorte. MÃªme si cela pourrait sembler Ã©trange ou inutile, cela vous permet de dÃ©finir un service qui est rÃ©fÃ©rencÃ© dans diffÃ©rents endroits (pods ou autres services) et de gÃ©rer le point dâextrÃ©mitÃ©/ domaine externe dÃ©fini en un seul endroit. Cela vous permet aussi dâabstraire le domaine en tant que service afin de lâÃ©changer plus tard pour un autre service Kubernetes.</p><h3>SÃ©lecteur</h3><p>Dans le cas des trois premiers types de service, nous avons un sÃ©lecteur. Il sâagit de sÃ©lectionner les pods pour cibler ceux qui traiteront la requÃªte de rÃ©seau (lâexportation ou Â«&thinsp;output&thinsp;Â» du service). Par exemple, nous pourrions avoir un service Web oÃ¹ nous ciblons tous les pods qui ont une Ã©tiquette Â«&thinsp;app&thinsp;Â» et une valeur de Â«&thinsp;web&thinsp;Â».</p><h3>Configuration dâun service simple</h3><p>CrÃ©er un nouveau fichier appelÃ© <strong>web-app-service.yaml</strong> et dont le contenu est:</p><pre class="wp-block-code"><code>apiVersion: v1
kind: Service
metadata:
 name: web-service
spec:
 ports:
 - name: http
 port: 80
 selector:
 app: web</code></pre><p>CrÃ©ez-le et dÃ©crivez-le :</p><pre class="wp-block-code"><code>$ kubectl create -f web-app-service.yaml
service/web-service created</code></pre><pre class="wp-block-code"><code>$ kubectl describe services web-service
Name: web-service
Namespace: default
Labels: &lt;none&gt;
Annotations: &lt;none&gt;
Selector: app=web
Type: ClusterIP
IP: 10.97.7.119
Port: http 80/TCP
TargetPort: 80/TCP
Endpoints: &lt;none&gt;
Session Affinity: None
Events: &lt;none&gt;</code></pre><p>Dans le cas ci-dessus, nous voyons que le point dâextrÃ©mitÃ© est nul. Endpoints: . Cette valeur montre les adresses IP du pod qui correspondent au sÃ©lecteur app=web spÃ©cifiÃ©, dans ce cas-ci, aucun ( pas de correspondance).</p><p>Maintenant, crÃ©ons deux pods avec les bonnes Ã©tiquettes qui correspondent au sÃ©lecteur. Nous pouvons faire Ã§a en crÃ©ant simplement deux pods gÃ©rÃ©s manuellement (plutÃ´t que par un dÃ©ploiement) en suivant les commandes suivantes :</p><pre class="wp-block-code"><code>$ kubectl run httpbin --generator=run-pod/v1 --image=kennethreitz/httpbin --labels=âapp=webâ
pod/httpbin created
$ kubectl run httpbin-2 --generator=run-pod/v1 --image=kennethreitz/httpbin --labels=âapp=webâ
pod/httpbin-2 created</code></pre><p>Une fois que ces pods sont planifiÃ©s et quâils fonctionnent bien, nous pouvons faire lâinspection des services encore une fois. Nous devrions voir ce qui suit pour les (points dâextrÃ©mitÃ©s) <strong>Endpoints:</strong></p><pre class="wp-block-code"><code>$ kubectl describe services web-service |
grep âEndpointsâ
Endpoints:
172.17.0.3:80,172.17.0.4:80</code></pre><p>Ces adresses IP appartiennent aux pods que nous venons de crÃ©er!</p><h3>AccÃ©der aux services</h3><p>Comme jâai mentionnÃ© plus haut, Kubernetes a crÃ©e une entrÃ©e DNS pour chaque service dÃ©fini. Dans le cas du service que nous avons crÃ©e, le serveur DNS de Kubernetes arrÃªtera le nom dâhÃ´te du service Web vers lâun des pods dans le service Web. Pour dÃ©montrer lâexemple, nous pouvons exÃ©cuter curl dans lâun des conteneurs, en nous assurant dâinstaller curl comme sâil nâÃ©tait pas inclus par dÃ©faut!</p><pre class="wp-block-code"><code>$ kubectl exec -it httpbin -- /bin/bash
$ apt update
...
$ apt install curl
...
$ curl web-service
&lt;!DOCTYPE html&gt;
&lt;html lang=âenâ&gt;
&lt;head&gt;
 &lt;meta charset=âUTF-8â&gt;
 &lt;title&gt;httpbin.org&lt;/title&gt;
...</code></pre><h3>Configuration dâun accÃ¨s externe via un service NodePort</h3><p>NodePort est lâun des moyens les plus simples de fournir un accÃ¨s externe Ã  vos pods Kubernetes. Pour configurer un service NodePort, nous devons configurer explicitement le Â«&thinsp;spec type&thinsp;Â» (autrement, par dÃ©faut, il sâagit de ClusterIP) dans une configuration de service :</p><pre class="wp-block-code"><code>spec:
 type: NodePort</code></pre><p>Pour en configurer un, crÃ©er un nouveau fichier appelÃ© <strong>web-app-nodeport-service.yaml </strong>et dont le contenu est :</p><pre class="wp-block-code"><code>apiVersion: v1
kind: Service
metadata:
 name: web-service-nodeport
spec:
 type: NodePort
 ports:
 - name: http
 port: 80
 selector:
 app: web</code></pre><p>CrÃ©ez-le et dÃ©crivez-le :</p><pre class="wp-block-code"><code>$ kubectl create -f web-app-nodeport-service.yaml
service/web-service-nodeport created
$ kubectl get services web-service-nodeport
NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE
web-service-nodeport NodePort 10.101.203.150 &lt;none&gt; 80:32285/TCP 23s</code></pre><p>En jetant un coup dâÅil au champ <strong>PORT</strong>, nous pouvons voir quâon lui a attribuÃ© le port <strong>32285</strong>. Câest le port qui est attribuÃ© Ã  chacun de nos nÅuds Kubernetes, qui Ã  leur tour, mandateront les pods appropriÃ©s.</p><p>Nous pouvons le tester en effectuant les commandes suivantes (prenez bien note quâil faudra utiliser votre adresse IP ou nom de domaine spÃ©cifique. Dans mon cas, ce nâest que lâadresse IP du nÅud interne de 192.168.122.188):</p><pre class="wp-block-code"><code>$ curl 192.168.122.188:32285
&lt;!DOCTYPE html&gt;
&lt;html lang=âenâ&gt;
&lt;head&gt;
 &lt;meta charset=âUTF-8â&gt;
...</code></pre><h2>Ingresses (entrÃ©es rÃ©seau)</h2><p>Les ingresses dÃ©signent un autre objet Kubernetes. Essentiellement, ce sont des versions dâun service aux fonctionnalitÃ©s plus complÃ¨tes. La fonction principale des ingresses tourne autour du routage des requÃªtes HTTP, ils partagent aussi des similaritÃ©s avec les<br> services. Vous aurez besoin dâinstaller ou de configurer un contrÃ´leur dâingresses spÃ©cifique, car il ne sera pas nÃ©cessairement configurÃ© par dÃ©faut. De plus, plusieurs contrÃ´leurs dâingresses peuvent fonctionner au mÃªme moment. Habituellement, chaque contrÃ´leur ne gÃ¨re que les ingresses qui ont les annotations kubernetes. io/ingress.class appropriÃ©es relatives au contrÃ´leur spÃ©cifique.</p><p>Les ingresses ciblent les services et non les pods.</p><h3>ContrÃ´leurs dâingresses</h3><p>MÃªme si les contrÃ´leurs dâingresses se conforment tous Ã  une interface ou spÃ©cification commune, ils incluent une configuration spÃ©cifique Ã  la mise en place. Le contrÃ´leur dâingresses Â«&thinsp;nginx ingress controller&thinsp;Â» est lâune des plus populaires. Cela fait habituellement rÃ©fÃ©rence au projet suivant :</p><p><a href="https://github.com/kubernetes/ingress-nginx">https://github.com/kubernetes/ingress-nginx</a> qui est un contrÃ´leur riche en fonctionnalitÃ©s offrant du soutien Ã  lâauthentification HTTP, Ã  lâaffinitÃ© de session, rÃ©Ã©criture dâURL, et plus encore.</p><h3>Configuration dâune entrÃ©e simple</h3><p>CrÃ©ez un nouveau fichier appelÃ© <strong>app-ingress.yaml</strong> et dont le contenu est (prenez note que nous mettons en place une rÃ¨gle pour un hÃ´te de <strong>example.com</strong>) :</p><pre class="wp-block-code"><code>apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
 name: app-ingress
 annotations:
 nginx.ingress.kubernetes.io/rewrite-target: /
spec:
 rules:
 - http:
 paths:
 - path: /
 backend:
 serviceName: web-service
 servicePort: 80</code></pre><p>CrÃ©ez-le et dÃ©crivez-le :</p><pre class="wp-block-code"><code>$ kubectl create -f app-ingress.yaml
ingress.networking.k8s.io/app-ingress
created</code></pre><pre class="wp-block-code"><code>$ kubectl describe ingresses app-ingress
Name: app-ingress
Namespace: default
Address: 192.168.122.188
Default backend: default-http-backend:80 (172.17.0.8:8080)
Rules:
 Host Path Backends
 ---- ---- --------
 example.com
 / web-service:80 (172.17.0.3:80,172.17.0.4:80)
Annotations:
 nginx.ingress.kubernetes.io/rewrite-target: /
Events:
 Type Reason Age From Message
 ---- ------ ---- ---- -------
 Normal CREATE 21m nginx-ingress-controller Ingress default/app-ingress
 Normal UPDATE 67s (x5 over 20m) nginx-ingress-controller Ingress default/app-ingress</code></pre><p>Et si nous essayons dâenvoyer une requÃªte HTTP avec curl Ã  lâadresse IP de lâingress :</p><pre class="wp-block-code"><code> $ curl -H âHost: example.comâ
http://192.168.122.188
&lt;!DOCTYPE html&gt;
&lt;html lang=âenâ&gt;
&lt;head&gt;
 &lt;meta charset=âUTF-8â&gt;
 &lt;title&gt;httpbin.org&lt;/title&gt;
 &lt;link href=âhttps://fonts.googleapis.com/css?family=Open+Sans:400,700|-
Source+Code+Pro:300,600|Titillium+Web:400,600,700â
...</code></pre><p>Dâun autre cÃ´tÃ©, si nous essayons un hÃ´te que nous nâavons pas configurÃ© :</p><pre class="wp-block-code"><code> $ curl -H âHost: example123.comâ
http://192.168.122.188
default backend - 404</code></pre><p>Nous obtenons la rÃ©ponse 404 page non trouvÃ©e â ce qui semble tout Ã  fait adÃ©quat, on ne sâattendait pas Ã  autre chose!</p><h3>Configuration dâun ingress avec SSL</h3><p>Nous utiliserons un certificat autosignÃ© pour dÃ©montrer la fonction SSL.</p><p>Nous nâavons pas encore parlÃ© des Â«&thinsp;secrets&thinsp;Â», mais nous allons devoir en installer un afin de configurer une clÃ© SSL et un certificat pour un ingress.</p><p>Pour cela, il faut effectuer la commande suivante :</p><pre class="wp-block-code"><code>$ kubectl create secret tls ssl-example-cert --key ssl.key --cert ssl.cert
secret/ssl-example-cert created</code></pre><p>Nous pouvons ajouter un certificat SSL en prÃ©cisant le secret, sous la clÃ© spec dans un ingress :</p><p>tls:</p><pre class="wp-block-code"><code> - secretName: ssl-example-cert</code></pre><p>Autrement dit, le contenu de notre fichier ingress sera :</p><pre class="wp-block-code"><code>apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
 name: app-ingress
 annotations:
 nginx.ingress.kubernetes.io/rewrite-target: /
spec:
 tls:
 - secretName: ssl-example-cert
 rules:
 - host: example.com
 http:
 paths:
 - path: /
 backend:
 serviceName: web-service
 servicePort: 80</code></pre><p>Maintenant, si nous essayons de point dâextrÃ©mitÃ© HTTPS du ingress (en ajoutant aussi le paramÃ¨tre -k Ã  curl afin dâignorer lâerreur de certificat autosignÃ©), nous verrons :</p><pre class="wp-block-code"><code>$ curl -k -H âHost: example.comâ
https://192.168.122.188/
&lt;!DOCTYPE html&gt;
&lt;html lang=âenâ&gt;
&lt;head&gt;
 &lt;meta charset=âUTF-8â&gt;
 &lt;title&gt;httpbin.org&lt;/title&gt;
 &lt;link href=âhttps://fonts.googleapis.com/css?family=Open+Sans:400,700|-
Source+Code+Pro:300,600|Titillium+Web:400,600,700â
...</code></pre><p>Maintenant que vous avez dÃ©couvert le rÃ©seau Kubernetes, il est temps dâen apprendre davantage. Notre ebook â<a href="https://info.cloudops.com/azure-kubernetes-services-la-securite-des-conteneurs-pour-un-monde-infonuagique-0">The Beginnerâs Guide to Kubernetes</a>â vous montrera ce qui peut Ãªtre fait de plus avec la mise en rÃ©seau Kubernetes et vous offrira des ressources Ã  propos des dÃ©ploiements, des volumes et de la sÃ©curitÃ© de Kubernetes.</p>
<div class="row">
    <div class="col-xl-8 offset-xl-2 col-lg-10 offset-lg-1 col-md-10 offset-md-1 col-sm-12 col-xs-12 cta-image">
      <img src="/images/blog/cta/kubernetesfr.png">
    </div>
</div>
            </article>
        </div>
    </div>


    <div class="row nav-buttons back-foward in-content">
        <div
            class="col-xl-4 offset-xl-2 col-lg-5 offset-lg-1 col-md-5 offset-md-1 col-sm-5 offset-sm-1 col-xs-2 back-button">
            
            <a href="/fr/blog/comparaison-des-services-mailles-istio-linkerd-et-consul-connect-x/"><button class="btn">
                    <div class="triangle-left">
                        <div class="inner-left-triangle"></div>
                    </div>Previous Post
                </button></a>
            
        </div>
        <div class="col-xl-4 col-lg-5 col-md-5 col-sm-5 col-xs-2 foward-button">
                
            <a href="/fr/blog/le-nuage-cause-t-il-des-changements-climatiques/">
                <button class="btn">
                    Next Post<div class="triangle-right">
                        <div class="inner-triangle"></div>
                    </div>
                </button></a>
                
        </div>
    </div>

    <div class="social">
        

<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
position: relative;
text-align: left; 
height: 36px; 
float: left; 
text-align: center;
}
#share-buttons > div > svg {height: 36px; fill: #005D91; margin-top: 0;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.facebook > svg {height: 30px; margin: auto 5px;}
#share-buttons > div.twitter > svg {height: 30px; margin: auto 5px;}
#share-buttons > div.linkedin > svg {height: 30px; margin: auto 5px;}
#share-buttons > div.mail > svg {height: 30px; margin: auto 5px;}
</style>

<div id="share-buttons">
<div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=\/fr\/blog\/reseautage-kubernetes-101\/');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
<div class="twitter" title="Share this on Twitter" onclick="window.open('http://twitter.com/home?status=\/fr\/blog\/reseautage-kubernetes-101\/');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
<div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=\/fr\/blog\/reseautage-kubernetes-101\/&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
<div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=\/fr\/blog\/reseautage-kubernetes-101\/');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>

        <i class="far fa-copy copy-page-link"></i>
    </div>

    

    <div class="contact-us-card general-stylings-more-content">
            <div class="row">
                <div class="col-xl-8 offset-xl-2 col-lg-8 offset-lg-2 col-md-10 offset-md-1 col-sm-12 col-xs-12 cta-cards">
                    <div class="card-deck">
                        <div class="card">
                            <a
                                href="https://cdn2.hubspot.net/hubfs/732832/CloudOps%20White%20Paper%20-%20A%20PreFlight%20Checklist%20for%20Cloud%20Migration.pdf">
                                <div class="card-body">
                                    <h3 class="card-title">A checklist for your cloud migration</h3>
                                    <p class="card-text">Download the white paper to get a step by step guide to a successful migration strategy.</p>
                                </div>
                                <div class="corner-triangle"></div>
                            </a>
                        </div>
                        <div class="card">
                            <a
                                href="/blog/the-cloudops-delivery-model-accelerated-value-delivery-through-code-and-collaboration">
                                <div class="card-body">
                                    <h3 class="card-title"> Accelerated value delivery</h3>
                                    <p class="card-text">Read more on how to maximize value through our unique delivery model.</p>
                                    <div class="corner-triangle"></div>
                            </a>
                        </div>
                    </div>
                    <div class="card">
                        <a href="https://cdn2.hubspot.net/hubfs/732832/Cloud-Ops_Cloud-Migration_v3.pdf">
                            <div class="card-body">
                                <h3 class="card-title">Cloud migration one-pager</h3>
                                <p class="card-text">
                                    Everything you need to know about how our services can help get your cloud journey started.
                                    <div class="corner-triangle"></div>
                            </div>
                        </a>
                    </div>
                    <div class="card">
                        <a href="/contact-us">
                            <div class="card-body">
                                <h3 class="card-title">Networking is the hardest part</h3>
                                <p class="card-text">Contact us to learn more about our hardware and software-defined networking solutions.</p>
                                <div class="corner-triangle"></div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

    </div>
</main>

        </div><div class="footer">
    <div class="row no-gutters logo">
        <div class="col-sm-12">
            <a href="/"><img class="cloudops-logo" src="/images/cO-logo-horizontal.png"
                    height="45px" width="auto"></a>
        </div>
    </div>

    <div class="row no-gutters footer-content">
        <div class="col-xl-3 offset-xl-2 col-lg-3 offset-lg-0 col-md-12">

            <a href="https://twitter.com/CloudOps_" target="_blank"><i class="fab fa-twitter"></i></a>
            <a href="https://www.linkedin.com/company/cloudops" target="_blank"><i class="fab fa-linkedin-in"></i></a>
            <a href="https://www.facebook.com/Cloud0ps/" target="_blank"><i class="fab fa-facebook-f"></i></a>
            <h5>Newsletter Signup</h5>
            <div class="newsletter-form">
                    <div class="newsletter-form">

<script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
<script>
  hbspt.forms.create({
	portalId: "732832",
	formId: "25575fb9-f01b-43a6-b9cd-2c154efad9f4"
});
</script>
                </div>
            </div>
        </div>
        <div class="col-xl-2 col-lg-3 col-md-12 col-sm-12 footer-nav">
            <h6>Services</h6>
            <ul>
                <li><a href="/cloud-native-consulting">Cloud Native Consulting</a></li>
                <li><a href="/transformations">Transformations</a></li>
                <li><a href="/managed-services-augmented-support">Support</a></li>
                <li><a href="/delivering-cloud">Delivering Cloud</a></li>
            </ul>
        </div>

        <div class="col-xl-2 col-lg-3 col-md-12 footer-nav">
            <h6>Learning</h6>
            <ul>
                <li><a href="/workshops">Workshops</a></li>
                <li><a href="/blog/blog-posts">Blog</a></li>
                <li><a href="/resources/white-papers">White Papers</a></li>
                <li><a href="/resources/case-studies">Case Studies</a></li>
            </ul>
        </div>

        <div class="col-xl-2 col-lg-3 col-md-12 footer-nav">
            <h6>Company</h6>
            <ul>
                <li><a href="/about-us">About Us</a></li>
                <li><a href="/careers">Careers</a></li>
                <li><a href="/partners">Partners</a></li>
                <li><a href="/why-cloudops">Why Cloudops</a></li>
            </ul>
        </div>
    </div>

    <div class="row no-gutters copyright">
        <div class="col-sm-12">
            <p>&copy; CloudOps. Tous droits rÃ©servÃ©s. // <a href="/privacy-policy">Privacy Policy</a></p>
        </div>
    </div>
</div>
        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
        <script src="/js/main.js"></script>

        </body>
</html>